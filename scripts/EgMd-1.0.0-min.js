!function(){function e(){this.dialect="Complex",this.is_debug=!0,this.debug_indent="",this.deleteSource=!0,this.deleteTree=!0,this.deleteHTML=!0,this.root="",this.rootAttr={},this.deleteH1=!0}function t(e){if(this.is_debug&&this.debug("buildOptions()	::arguments:\n",arguments),e=e||{},"object"!=typeof e||g(e))throw new TypeError("Unexpert param(options) at buildOptions("+e+")");return e.isset||(e.isset=!0,e.deleteSource=e.deleteSource||this.deleteSource,e.deleteTree=e.deleteTree||this.deleteTree,e.deleteHTML=e.deleteHTML||this.deleteHTML,e.deleteH1=e.deleteH1||this.deleteH1,e.root=e.root||"string"==typeof e.root?e.root:this.root,e.rootAttr=e.rootAttr||this.rootAttr||{},e.dialect=y(e.dialect||this.dialect),this.options=e),e}function r(t){if(t=t||"","string"!=typeof t&&"undefined"!=typeof t)throw new Error("Markdown Expect Stirng param");if(e.call(this),arguments[1]){var r=arguments[1];"function"==typeof r?r.call(this):this.dialect=r}n.call(this),this.source=t,this.listener={all:[]}}function n(){this.em_state=[],this.strong_state=[],this.references={},this.tree=null,this.Header=[],this.html=""}function i(e){for(var t=0,r=-1;-1!==(r=e.indexOf("\n",r+1));)t++;return t}function s(e){e=e.replace(/(\r\n|\n|\r)/g,"\n");var t=/([\s\S]+?)($|\n#|\n(?:\s*\n|$)+)/g,r=[],n,s=1;for(null!==(n=/^(\s*\n)/.exec(e))&&(s+=i(n[0]),t.lastIndex=n[0].length);null!==(n=t.exec(e));)"\n#"===n[2]&&(n[2]="\n",t.lastIndex--),r.push(p(n[1],n[2],s)),s+=i(n[0]);return r}function l(){this.is_debug&&this.debug("SOURCE:\n\n"+this.source,"\n\ntoHtmlTree()	::arguments:\n",arguments);try{var e=this.toMDTree(this.source);if("markdown"===e[0]&&this.options.root){e[0]=this.options.root.slice(0);var t=m(this.options.rootAttr);v(e)?e[1]=t:e.splice(1,0,t)}var r=a.call(this,e);return c(r),r}finally{this.options.deleteSource&&(this.source=""),this.options.deleteTree&&(this.tree=null)}}function a(e){this.is_debug&&this.debug("convert_md_tree_to_html_tree()	::tree:\n",e);var t,r=this.options,n=e;if("string"==typeof n)return n;var i=v(n),s=r.dialect.__convert_tree__.call(this,n);if("string"==typeof s)return s;if(t=1,i){for(var l in n[1]){t=2;break}1===t&&n.splice(t,1)}if(n[0].match(/[hH][1-6]/)){var o=n[0].charAt(1);if(g(this.Header)||(this.Header=[]),g(this.Header[o])||(this.Header[o]=[]),this.Header[o].push(n),"1"===o&&this.options.deleteH1)return""}for(;t<n.length;++t)n[t]=a.call(this,n[t]);return n}function o(e){if("string"==typeof e)return h(e);for(var t=e[0],r=v(e),n=[],i=r?2:1,s=e.length;s>i;i++)n.push(o(e[i]));var l="";for(var a in r)l+=" "+a+'="'+h(r[a])+'"';return"img"===t||"br"===t||"hr"===t?"<"+t+l+"/>":"<"+t+l+">"+n.join("")+"</"+t+">"}function h(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function c(e){for(var t=v(e)?2:1;t<e.length;)"string"==typeof e[t]?t+1<e.length&&"string"==typeof e[t+1]?e[t]+=e.splice(t+1,1)[0]:""===e[t]?e.splice(t,1):++t:(c(e[t]),++t)}function u(e,t){function r(e){this.len_after=e,this.name="close_"+t}var n=e+"_state",i="strong"===e?"em_state":"strong_state";return function(s){if(this[n][0]===t)return this[n].shift(),[s.length,new r(s.length-t.length)];var l=this[i].slice(),a=this[n].slice();this[n].unshift(t);var o=this.processInline(s.substr(t.length)),h=o[o.length-1],c=this[n].shift();if(h instanceof r){o.pop();var u=s.length-h.len_after;return[u,[e].concat(o)]}return this[i]=l,this[n]=a,[t.length,t]}}var f={},p=f.mkBlock=function(e,t,r){if("string"!=typeof e)throw new Error("`mk_block` expect string param");1===arguments.length&&(t="/n/n");var n=new String(e);return n.trail=t,n.toSource=function(){return'new mk_block("'+this.toString()+'" , "'+this.trail+'" , '+this.lineNum+")"},n.lineNum=r?r:void 0,n},g=f.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},d=f.forEach=function(){return Array.prototype.forEach?function(e,t,r){return e.forEach(t,r)}:function(e,t,r){for(var n=0;n<e.length;n++)t.call(r||e,e[n],n,e)}}(),_=f.isEmpty=function(e){for(var t in e)if(hasOwnProperty.call(e,t))return!1;return!0},v=f.getAttrOfJsonML=function(e){return g(e)&&e.length>1&&"object"==typeof e[1]&&!g(e[1])?e[1]:void 0},m=f.clone_attr=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t},b=f.argToArray=function(e){return Array.prototype.slice.call(e)};r.prototype.on=function(e){var t,r,n;if(arguments[2])t=arguments[2],r=arguments[1];else{if("function"!=typeof arguments[1])throw new TypeError("Markdown.on TypeError");t=arguments[1]}if("string"!=typeof e||"function"!=typeof t&&"string"!=typeof t)throw new TypeError("Markdown.on TypeError");return"all"===e?this.listener.all.push({fun:t,data:r}):(this.listener[e]||(this.listener[e]=[]),this.listener[e].push({fun:t,data:r})),this},r.prototype.trigger=function(e,t){function r(e){}var n=this.listener[e];n&&d(n,function(e){e.data&&t.push(e.data),e.fun.apply(this,t)},this),d(this.listener.all,function(e){e.data?e.fun.call(this,e.data):e.fun.call(this)},this)},r.prototype.off=function(e,t){var r;if("function"==typeof t&&"string"==typeof e){if(r=this.listener[e])for(var n in r)if(r[n].fun===t){r.splice(n,1);break}}else{if("string"!=typeof e)throw new TypeError("Markdown.unbind Unexpect param");this.listener[e]&&(this.listener[e]=[])}},r.dialects={},r.prototype.debug=function(){var e=Array.prototype.slice.call(arguments);e.unshift(this.debug_indent),"undefined"!=typeof console&&"undefined"!=typeof console.log&&console.log.apply(console,e)};var y=r.getDialect=function(e){switch(typeof e){case"object":return e;default:if(e in r.dialects)return r.dialects[e];throw new Error("Unknown Markdown dialect '"+String(e)+"'")}};r.prototype.buildOptions=t,r.prototype.processBlock=function w(e,t){var r=this.options.dialect.block,n=r.__order__;if("__call__"in r)return r.__call__.call(this,e,t);for(var i=0;i<n.length;i++){var s=r[n[i]].call(this,e,t);if(s){if(this.is_debug&&this.debug(this.options.dialect.name+"::"+n[i]+"(block,next)	::arguments:\n",arguments,"\n result:\n",s),!g(s))throw new Error(this.options.dialect.name+"::"+n[i]+"return an illegal Result("+typeof s+")");return s}}return[]},r.prototype.processInline=function x(e){return this.is_debug&&this.debug("processInline()	::arguments\n",arguments),this.options.dialect.inline.__call__.call(this,String(e))},r.prototype.toMDTree=function T(e,t){var r=e instanceof Array?e:s(e);this.is_debug&&this.debug("toMDTree()	::arguments:\n",arguments,"\n blocks:\n",r);var n=this.tree;try{for(this.tree=t||this.tree||["markdown"];r.length;){var i=this.processBlock(r.shift(),r);i.length&&this.tree.push.apply(this.tree,i)}return this.tree}finally{t&&(this.tree=n)}},r.prototype.Reset=function(e){if("string"==typeof e)this.source=e;else{if("function"!=typeof e)throw new Error("Unexpected param");e.call(this)}n.call(this)},r.prototype.toTree=function(){var e;"string"==typeof arguments[0]?(this.Reset(arguments[0]),e=arguments[1]):e=arguments[0],e=this.buildOptions(e);var t=l.call(this,e);return this.trigger("toTree",[t]),t},r.prototype.renderJsonML=function E(e,t){this.id_debug&&this.debug("renderJsonML	::arguments:\n",arguments),t=this.buildOptions(t);var r=[];if(t.root)r.push(o(e));else for(var n=e.length,i=v(e)?2:1;n>i;i++)r.push(o(e[i]));return this.options.deleteHTML?(this.html="",r.join("")):(this.html=r.join(""),this.html)},r.prototype.toHTML=function(e){this.is_debug&&this.debug("toHTML("+b(arguments).join(" , ")+")");var t;"string"==typeof e?(this.Reset(e),this.buildOptions(arguments[1])):t=this.buildOptions(e);var r=l.call(this,t);this.Header&&d(this.Header,function(e,t,r){d(e,function(e,t,r){r[t]=o(e)})});var n=this.renderJsonML(r,t);return this.trigger("toHTML",[n]),n},r.buildBlockOrder=function(e){if("object"!=typeof e)throw new TypeError("Unexpected param at Markdown.buildBlockOrder");var t=[];for(var r in e)(!r.match(/^__.*__$/)||e.hasOwnProperty(r))&&t.push(r);e.__order__=t},r.buildInlineRegExp=function(e){if("object"!=typeof e)throw new TypeError("Unexpected param at Markdown.buildInlineRegExp");var t=[];for(var r in e)if(!r.match(/^__.*__$/)&&e.hasOwnProperty(r)){var n=r.replace(/([\\.*+?|\()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");t.push(1===r.length?n:"(?:"+n+")")}if(t=t.join("|"),e.__regExp__=t,e.__call__){var i=e.__call__;e.__call__=function(e,r){return void 0!==r?i.call(this,e,r):i.call(this,e,t)}}},r.addDialect=function(e){if("object"!=typeof e)throw new TypeError("Unexpected param at Markdown.addDialect");if(r.dialects[e.name])throw new Error("`"+e.name+"` has already exist!");r.dialects[e.name]=e},r.removeDialect=function(e){if("object"==typeof e){var t=r.dialects;for(var n in t)t[n]===e&&delete t[n]}else{if("string"!=typeof e)throw new TypeError("Unexpected param at Markdown.removeDialect()");delete r.dialects[e]}};var k={name:"Complex",block:{atxHeader:function M(e,t){var r=e.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(r){var n=["header",{level:r[1].length}];return Array.prototype.push.apply(n,this.processInline(r[2])),r[0].length<e.length&&t.unshift(p(e.substr(r[0].length),e.trailing,e.lineNum+2)),[n]}},setextHeader:function H(e,t){var r=e.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(r){var n="="===r[2]?1:2,i=["header",{level:n}];return Array.prototype.push.apply(i,this.processInline(r[1])),r[0].length<e.length&&t.unshift(p(e.substr(r[0].length),e.trailing,e.lineNum+2)),[i]}},code:function A(e,t){function r(e){var t=e.valueOf(),r=null;return(r=t.match(l))&&(t=t.substr(r[0].length),a={},a.codeType=r[1]?r[1]:"cpp",a.lineNumber=r[2]?r[2]:null),t}function n(e){i.push(e[1])}var i=[],s=/^(?: {0,3}\t| {4})(.*)\n?/,l=/^(?: {0,3}\t| {4})\s*\[(.*?)\](?:\s*\[(.*?)\])?[ \t]*\n?/,a=null;if(e.match(s)){var o=r(e);e:for(;;){if(o=k.loop_reg_over_block(s,o,n),o.length){t.unshift(p(o,e.trailing));break e}if(!t.length)break e;if(t[0].match(l)||!t[0].match(s))break e;i.push(e.trail.replace(/[^\n]/g,"").substring(2)),o=t.shift().valueOf()}var h=["code_block"];return a&&h.push(a),h.push(i.join("\n")),[h]}},horizRule:function O(e,t){var r=e.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(r){var n="";switch(r[2]){case"-":n="dec";break;case"_":n="dash";break;case"*":n="star";break;default:n=""}var i=[["hr",{"class":n}]];if(r[1]){var s=p(r[1],"",e.lineNum);i.unshift.apply(i,this.toMDTree(s,[]))}return r[3]&&t.unshift(p(r[3],e.trailing,e.lineNum+1)),i}},lists:function(){function e(e){return new RegExp("(?:^("+o+"{0,"+e+"} {0,3})("+s+")\\s+)|(^"+o+"{0,"+(e-1)+"}[ ]{0,4})")}function t(e){return e.replace(/ {0,3}\t/g,"    ")}function r(e,t,r,n){if(t)return void e.push(["para"].concat(r));var i=e[e.length-1]instanceof Array&&"para"===e[e.length-1][0]?e[e.length-1]:e;n&&e.length>1&&r.unshift(n);for(var s=0;s<r.length;s++){var l=r[s],a="string"==typeof l;a&&i.length>1&&"string"==typeof i[i.length-1]?i[i.length-1]+=l:i.push(l)}}function n(e,t){for(var r=new RegExp("^("+o+"{"+e+"}.*?\\n?)*$"),n=new RegExp("^"+o+"{"+e+"}","gm"),i=[];t.length>0&&r.exec(t[0]);){var s=t.shift(),l=s.replace(n,"");i.push(p(l,s.trailing,s.lineNum))}return i}function i(e,t,r){var n=e.list,i=n[n.length-1];if(!(i[1]instanceof Array&&"para"===i[1][0]))if(t+1===r.length)t=1,i instanceof Object&&(t=2),i.push(["para"].concat(i.splice(t,i.length-1)));else{var s=i.pop();i.push(["para"].concat(i.splice(1,i.length-1)),s)}}var s="[*+-]|\\d+(?:\\.)",l=/[*+-]/,a=new RegExp("^( {0,3})("+s+")[ 	]+"),o="(?: {0,3}\\t| {4})";return function(s,o){function h(e){var t=l.exec(e[2])?["bulletlist"]:["numberlist"];return p.push({list:t,indent:e[1]}),t}function c(e){var t=["listitem"];switch(e){case"+":e="add";break;case"-":e="dec";break;case"*":e="star";break;default:e=e.replace(/\.$/g,"")}return t.push({"class":e}),t}function u(e){return k=e,""}var f=s.match(a);if(f){for(var p=[],g=h(f),_,v=!1,m=[p[0].list],b,y="",k="",w;;){w=s.split(/(?=\n)/),y="",k="";for(var x=0;x<w.length;x++){k="";var T=w[x].replace(/^\n/,u),E=e(p.length);if(f=T.match(E),void 0!==f[1]){y.length&&(r(_,v,this.processInline(y),k),v=!1,y=""),f[1]=t(f[1]);var M=Math.floor(f[1].length/4)+1;if(M>p.length)g=h(f),_.push(g),_=g[1]=c(f[2]);else{var H=!1;for(b=0;b<p.length;b++)if(p[b].indent===f[1]){g=p[b].list,p.splice(b+1,p.length-(b+1)),H=!0;break}H||(M++,M<=p.length?(p.splice(M,p.length-M),g=p[M-1].list):(g=h(f),_.push(g))),_=c(f[2]),g.push(_)}k=""}T.length>f[0].length&&(y+=k+T.substr(f[0].length))}y.length&&(r(_,v,this.processInline(y),k),v=!1,y="");var A=n(p.length,o);A.length>0&&(d(p,i,this),_.push.apply(_,this.toMDTree(A,[])));var O=o[0]&&o[0].valueOf()||"";if(!O.match(a)&&!O.match(/^ /))break;s=o.shift();var S=this.options.dialect.block.horizRule(s,o);if(S){m.push.apply(m,S);break}d(p,i,this),v=!0}return m}}}(),blockquote:function S(e,t){if(e.match(/^>/m)){var r=[];if(">"!==e[0]){for(var n=e.split(/\n/),i=[],s=e.lineNum;n.length&&">"!==n[0][0];)i.push(n.shift()),s++;var l=p(i.join("\n"),"\n",e.lineNum);r.push.apply(r,this.processBlock(l,[])),e=p(n.join("\n"),e.trailing,s)}for(;t.length&&">"===t[0][0];){var a=t.shift();e=p(e+e.trailing+a,a.trailing,e.lineNum)}var o=e.replace(/^> ?/gm,""),h=this.tree,c=this.toMDTree(o,["blockquote"]),u=v(c);return u&&u.references&&(delete u.references,_(u)&&c.splice(1,1)),r.push(c),r}},referenceDefn:function j(e,t){var r=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/;if(e.match(r)){this.references||(this.references={});var n=this.references,i=k.loop_reg_over_block(r,e,function(e){e[2]&&"<"===e[2][0]&&">"===e[2][e[2].length-1]&&(e[2]=e[2].substring(1,e[2].length-1));var t=n[e[1].toLowerCase()]={href:e[2]};void 0!==e[4]?t.title=e[4]:void 0!==e[5]&&(t.title=e[5])});return i.length&&t.unshift(p(i,e.trailing)),[]}},table:function L(e){var t=function(e,t){t=t||"\\s",t.match(/^[\\|\[\]{}?*.+^$]$/)&&(t="\\"+t);for(var r=[],n=new RegExp("^((?:\\\\.|[^\\\\"+t+"])*)"+t+"(.*)"),i;i=e.match(n);)r.push(i[1]),e=i[2];return r.push(e),r},r=/^ {0,3}\|(.+)\n {0,3}\|\s*([\-:]+[\-| :]*)\n((?:\s*\|.*(?:\n|$))*)(?=\n|$)/,n=/^ {0,3}(\S(?:\\.|[^\\|])*\|.*)\n {0,3}([\-:]+\s*\|[\-| :]*)\n((?:(?:\\.|[^\\|])*\|.*(?:\n|$))*)(?=\n|$)/,i,s;if(s=e.match(r))s[3]=s[3].replace(/^\s*\|/gm,"");else if(!(s=e.match(n)))return;var l=["table",["thead",["tr"]],["tbody"]];s[2]=s[2].replace(/\|\s*$/,"").split("|");var a=[];for(d(s[2],function(e){e.match(/^\s*-+:\s*$/)?a.push({align:"right"}):e.match(/^\s*:-+\s*$/)?a.push({align:"left"}):e.match(/^\s*:-+:\s*$/)?a.push({align:"center"}):a.push({})}),s[1]=t(s[1].replace(/\|\s*$/,""),"|"),i=0;i<s[1].length;i++)l[1][1].push(["th",a[i]||{}].concat(this.processInline(s[1][i].trim())));return d(s[3].replace(/\|\s*$/gm,"").split("\n"),function(e){var r=["tr"];for(e=t(e,"|"),i=0;i<e.length;i++)r.push(["td",a[i]||{}].concat(this.processInline(e[i].trim())));l[2].push(r)},this),[l]},para:function R(e){return[["para"].concat(this.processInline(e))]}},inline:{__oneElement__:function I(e,t,r){var n,i,s,l=this.options.dialect;return t=t||l.inline.__regExp__,s=new RegExp("([\\s\\S]*?)("+(t.source||t)+")"),(n=s.exec(e))?n[1]?[n[1].length,n[1]]:(n[2]in l.inline&&(i=l.inline[n[2]].call(this,e.substr(n.index),n,r||[])),i=i||[n[2].length,n[2]]):[e.length,e]},__call__:function N(e,t){function r(e){"string"==typeof e&&"string"==typeof n[n.length-1]?n[n.length-1]+=e:n.push(e)}this.is_debug&&this.debug("inline.__call__()	::arguments\n",arguments);for(var n=[],i,s=this.options.dialect;e.length>0;)i=s.inline.__oneElement__.call(this,e,t,n),e=e.substr(i.shift()),d(i,r);return n},"]":function(){},"}":function(){},__escape__:/^\\[\\`\*_{}\[\]()#\+.!\-]/,"\\":function D(e){return this.options.dialect.inline.__escape__.exec(e)?[2,e.charAt(1)]:[1,"\\"]},"![":function U(e){var t=e.match(/^!\[(.*?)\][ \t]*\([ \t]*([^")]*?)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(t){t[2]&&"<"===t[2][0]&&">"===t[2][t[2].length-1]&&(t[2]=t[2].substring(1,t[2].length-1)),t[2]=this.options.dialect.inline.__call__.call(this,t[2],/\\/)[0];var r={alt:t[1],href:t[2]||""};return void 0!==t[4]&&(r.title=t[4]),[t[0].length,["img",r]]}return t=e.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/),t?[t[0].length,["img_ref",{alt:t[1],ref:t[2].toLowerCase(),original:t[0]}]]:[2,"!["]},"[":function B(e){var t=String(e),r=k.inline_until_char.call(this,e.substr(1),"]");if(!r)return[1,"["];var n=1+r[0],i=r[1],s,l;e=e.substr(n);var a=e.match(/^\s*\([ \t]*([^"']*)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(a){var o=a[1];if(n+=a[0].length,o&&"<"===o[0]&&">"===o[o.length-1]&&(o=o.substring(1,o.length-1)),!a[3])for(var h=1,c=0;c<o.length;c++)switch(o[c]){case"(":h++;break;case")":0===--h&&(n-=o.length-c,o=o.substring(0,c))}return o=this.options.dialect.inline.__call__.call(this,o,/\\/)[0],l={href:o||""},void 0!==a[3]&&(l.title=a[3]),s=["link",l].concat(i),[n,s]}return a=e.match(/^\s*\[(.*?)\]/),a?(n+=a[0].length,l={ref:(a[1]||String(i)).toLowerCase(),original:t.substr(0,n)},s=["link_ref",l].concat(i),[n,s]):1===i.length&&"string"==typeof i[0]?(l={ref:i[0].toLowerCase(),original:t.substr(0,n)},s=["link_ref",l,i[0]],[n,s]):[1,"["]},"<":function C(e){var t;return null!==(t=e.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))?t[3]?[t[0].length,["link",{href:"mailto:"+t[3]},t[3]]]:"mailto"===t[2]?[t[0].length,["link",{href:t[1]},t[1].substr("mailto:".length)]]:[t[0].length,["link",{href:t[1]},t[1]]]:[1,"<"]},"`":function J(e){var t=e.match(/(`+)(([\s\S]*?)\1)/);return t&&t[2]?[t[1].length+t[2].length,["inlinecode",{"class":"code"+t[1].length.toString()},t[3]]]:[1,"`"]},"  \n":function P(){return[3,["linebreak"]]}},__convert_tree__:function(e){var t=v(e),r=this.references;switch(e[0]){case"header":e[0]="h"+e[1].level,delete e[1].level;break;case"bulletlist":e[0]="ul";break;case"numberlist":e[0]="ol";break;case"listitem":e[0]="li";break;case"para":e[0]="p";break;case"markdown":e[0]="html";break;case"code_block":e[0]="pre";var n=["code"],i=1;t&&(i=2,e[1].lineNumber&&(e[1]["class"]=e[1].lineNumber),e[1].codeType&&n.push({"class":e[1].codeType}),delete e[1].lineNumber,delete e[1].codeType),n.push.apply(n,e.splice(i,e.length-i)),e[i]=n;break;case"inlinecode":e[0]="code";break;case"img":e[1].src=e[1].href,delete e[1].href;break;case"linebreak":e[0]="br";break;case"link":e[0]="a";break;case"link_ref":e[0]="a";var s=r[t.ref];if(!s)return t.original;delete t.ref,t.href=s.href,s.title&&(t.title=s.title),delete t.original;break;case"img_ref":e[0]="img";var s=r[t.ref];if(!s)return t.original;delete t.ref,t.src=s.href,s.title&&(t.title=s.title),delete t.original}}};k.inline["**"]=u("strong","**"),k.inline.__=u("strong","__"),k.inline["*"]=u("em","*"),k.inline._=u("em","_"),k.inline_until_char=function(e,t){for(var r=0,n=[];;){if(e.charAt(r)===t)return r++,[r,n];if(r>=e.length)return null;var i=this.options.dialect.inline.__oneElement__.call(this,e.substr(r));r+=i[0],n.push.apply(n,i.slice(1))}},k.loop_reg_over_block=function(e,t,r){for(var n,i=t.valueOf();i.length&&(n=e.exec(i));)i=i.substr(n[0].length),r.call(this,n);return i},r.buildBlockOrder(k.block),r.buildInlineRegExp(k.inline),r.addDialect(k),window.Markdown=r}();