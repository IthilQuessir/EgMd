Md.extend("syntax/block",function(e){function n(){this.lib=[]}return n.prototype.extend=function(e){this.lib.push(e)},n.prototype.parse=function(e){var n,t=[e],r=null,i=this.lib.length,s=null;do for(r=[],e=t.pop(),n=0;n<i;n++){if(s=this.lib[n].parse(e,r),r.length&&(r.reverse(),t.push.apply(t,r)),s){node.appendChild(s);break}r.length&&(e=t.pop())}while(t.length);for(;++n<i;)if(grammar=new expendGrammars[n],r=[],s=grammar.parse(e,r),r.length&&null===s)r.reverse(),e=r.pop(),t.push.apply(t,r);else{if(r.length){r.reverse(),t.push.apply(t,r);break}if(null!==s)break}return s},n.expend=function(e){expendGrammars.push(e)},n}),Md.extend("syntax/inline",function(e){function n(){this.lib=[]}return n.prototype.extend=function(e){this.lib.push(e)},n.prototype.parse=function(e){var n,t=[e],r=null,i=this.lib.length,s=null,l=new Node;do for(r=[],e=t.pop(),n=0;n<i;n++){if(s=this.lib[n].parse(e,r),r.length&&(r.reverse(),t.push.apply(t,r)),s){l.appendChild(s);break}r.length&&(e=t.pop())}while(t.length);return l},n}),Md.extend("syntax/combin-block",function(e){function n(e){this.block=e.getSyntax("block"),this.block.extend(this)}return n.prototype.parse=function(e){var n=/($|\n(?:\s*\n|\s*$)+)/,t=e.split(n);if(console.log(t),!(t.length>1))return null},n}),Md.extend("syntax/atx-header",function(e){function n(e){var n=e.getSyntax("block");n.extend(this),this.inline=e.getSyntax("inline")}var t=e("node"),r=/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/;return n.prototype.parse=function(e,n){if(!r.test(e))return null;var i=e.match(r),s=new t("h"+i[1].length);return s.appendChild(new TextNode(i[2])),i[0].length<e.length&&n.push(e.substr(i[0].length)),s},n}),Md.extend("syntax/horiz-line",function(e){function n(e){var n=e.getSyntax("block");n.extend(this)}var t={dash:"dash",underline:"underline",asterisk:"asterisk"};return n.prototype.parse=function(e,n){var r=/^(?:([\s\S]*?)\n)?[ \t]*(([-_*])(?:[ \t]*\3){2,})[ \t]*(?:\n([\s\S]*))?$/,i=e.match(r),s=null;if(!i)return null;if(i[1])return n.push(i[1]),n.push(i[2]),i[4]&&n.push(i[4]),null;switch(s=new Node("hr"),i[3]){case"-":s.attr("class",t.dash);break;case"_":s.attr("class",t.underline);break;case"*":s.attr("class",t.asteris)}return i[4]&&n.push(i[4]),s},n}),Md.extend("syntax/escaped",function(e){function n(e){var n=e.getSyntax("block");n.extend(this)}return n.prototype.parse=function(e,n){var t=/\\([\\`\*_{}\[\]()#\+.!\-])/,r=t.exec(e);return t.test(e)?0===r.index?(n.push(e.substr(r[0].length)),new TextNode(r[1])):(n.push(e.substring(0,r.index)),n.push(e.substr(r.index)),null):null},n}),Md.extend("syntax/inline-plain-text",function(e){function n(){}var t=e("text-node");return n.prototype.parse=function(e){return new t(e)},n}),Md.extend("dialects/office",function(e){e("dialect-builder");return(new dialectBuilder).setSyntax(["block","inline","combin-block","atx-header","horiz-line","pragraph","escaped","inline-plain-text"]).build()});